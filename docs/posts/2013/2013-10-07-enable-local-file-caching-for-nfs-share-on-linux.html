<!doctype html>
<html lang="">
<head>
	<meta charset="utf-8"/>
	<title>Enable local file caching for NFS share on Linux - 0ink.net</title>
	<meta name="author" content="Alejandro Liu">


	<meta name="description" content="In Linux, there is a caching filesystem called FS-Cache which enables file caching for network file systems such as NFS. FS-Cache is built into the Linux kernel 2.6.30 and higher. In order for FS-Cache to operate, it needs cache back-end which provides actual storage for caching. One such …">
	<meta name="int-title" content="Enable local file caching for NFS share on Linux">
	<meta name="tags" content="centos, configuration, filesystem, information, installation, linux, network, partition, remote, service, storage, sudo, ubuntu">
	<meta name="date" content="2013-10-07 00:00:00+02:00">
	<meta name="revised" content="2021-12-22">


	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link rel="stylesheet" href="/theme/css/main.css" type="text/css" />


</head>

<body>

    <div class="container">

	  <header role="banner">
	    <div class="feeds">
	    </div>
		<nav class="pages">
			    <a href="/pages/about.html">About</a>
-			    <a href="/pages/privacy-policy.html">Privacy Policy</a>
		</nav>
		<a href="/" class="title"
 title="Not the site you are looking for..."		>
		0ink.net</a>
	      <div class="logo">
		<a href="/" class="title"
 title="Not the site you are looking for..."		>
		  <img src="/images/2021/0ink.png" width="44" height="44" />
		</a>
	      </div>



      </header>

	  <div class="wrapper">

		  <div role="main" class="content">
			<iframe src="https://duckduckgo.com/search.html?site=0ink.net&prefill=Search with DuckDuckGo" style="overflow:hidden;margin:5px;padding:0;width:408px;height:40px;" frameborder="0"></iframe>

	<article class="full">

		<h1>Enable local file caching for NFS share on Linux</h1>

<div class="metadata">
  <time datetime="2013-10-07T00:00:00+02:00" pubdate>Mon 07 October 2013</time>
    <address class="vcard author">
      by <a class="url fn" href="/author/alejandro-liu.html">Alejandro Liu</a>
    </address>
  in <a href="/category/c2013.html">2013</a>
<p class="tags">tagged <a href="/tag/centos.html">centos</a>, <a href="/tag/configuration.html">configuration</a>, <a href="/tag/filesystem.html">filesystem</a>, <a href="/tag/information.html">information</a>, <a href="/tag/installation.html">installation</a>, <a href="/tag/linux.html">linux</a>, <a href="/tag/network.html">network</a>, <a href="/tag/partition.html">partition</a>, <a href="/tag/remote.html">remote</a>, <a href="/tag/service.html">service</a>, <a href="/tag/storage.html">storage</a>, <a href="/tag/sudo.html">sudo</a>, <a href="/tag/ubuntu.html">ubuntu</a></p></div>
		<p>In Linux, there is a caching filesystem called <code>FS-Cache</code> which enables
file caching for network file systems such as NFS. <code>FS-Cache</code> is built
into the Linux kernel 2.6.30 and higher. In order for <code>FS-Cache</code> to
operate, it needs cache back-end which provides actual storage for
caching. One such cache back-end is <code>cachefiles</code>. Therefore, once you
set up <code>cachefiles</code>, it will automatically enable file caching for NFS shares.</p>
<h1>Requirements</h1>
<p>One requirement for setting up <code>cachefiles</code> is that local filesystem support user-defined extended file attributes (i.e., <code>xattr</code>), because <code>cachefiles</code> use <code>xattr</code> to store extra information for cache maintenance. If your local filesystem is ext4-type, you don't need to worry about this since <code>xattr</code> is enabled in ext4 by default. However, if you are using ext3 filesystem, then you need to mount the local filesystem with "user_xattr" option. To do so, edit /etc/mtab to add "user_xattr" mount option to the disk partition that will be used by <code>cachefiles</code> for file caching. For example, assuming that /dev/hda1 is such a partition:</p>
<hr>
<div class="highlight"><pre><span></span><code>/dev/hda1 / ext3 rw,user_xattr  0 0
</code></pre></div>

<hr>
<p>After modifying /etc/fstab, reload it by running:</p>
<div class="highlight"><pre><span></span><code>$ sudo mount -o remount / 
</code></pre></div>

<h1>Configure CacheFiles</h1>
<p>In order to set up cache back-end using <code>cachefiles</code>, you need to install <code>cachefilesd</code>, a userspace daemon for managing <code>cachefiles</code>. To install <code>cachefilesd</code> on Ubuntu or Debian:</p>
<div class="highlight"><pre><span></span><code>$ sudo apt-get install cachefilesd
</code></pre></div>

<p>To install <code>cachefilesd</code> on CentOS, Fedora or RedHat:</p>
<div class="highlight"><pre><span></span><code>$ sudo yum install cachefilesd
$ sudo chkconfig cachefilesd on
</code></pre></div>

<p>After installation, enable <code>cachefilesd</code> by editing its configuration file as follows.</p>
<div class="highlight"><pre><span></span><code>$ sudo vi /etc/default/cachefilesd
</code></pre></div>

<hr>
<div class="highlight"><pre><span></span><code>RUN=yes
</code></pre></div>

<hr>
<p>Next, mount a remote NFS share with <code>fsc</code> option:</p>
<div class="highlight"><pre><span></span><code> $ sudo vi /etc/fstab
</code></pre></div>

<hr>
<div class="highlight"><pre><span></span><code> 192.168.1.13:/home/xmodulo /mnt nfs rw,hard,intr,fsc
</code></pre></div>

<hr>
<p>Alternatively, if you mount the remote NFS share from the command line, specify <code>fsc</code> as a command-line option:</p>
<div class="highlight"><pre><span></span><code>$ sudo mount -t nfs <span class="m">192</span>.168.1.13:/home/xmodulo /mnt -o fsc
</code></pre></div>

<p>Finally, restart <code>cachefilesd</code>:</p>
<div class="highlight"><pre><span></span><code>$ sudo service cachefilesd restart
</code></pre></div>

<p>At this point, file caching should be enabled for the mounted NFS share, which means that previously accessed files in the mounted NFS share will be retrieved from local file cache. If you want to flush NFS file cache for any reason, simply restart <code>cachefilesd</code>.</p>
<div class="highlight"><pre><span></span><code> $ sudo service cachefilesd restart 
</code></pre></div>

<p>Source: <a href="http://xmodulo.com/2013/06/how-to-enable-local-file-caching-for-nfs-share-on-linux.html">xmodule.com</a></p>

	</article>


		  </div>

		  <div class="sidebar">

	        <nav>
	          <h2>Years</h2>
	          <ul>
	              <li ><a href="/category/c2021.html">2021</a></li>
	              <li ><a href="/category/c2020.html">2020</a></li>
	              <li ><a href="/category/c2019.html">2019</a></li>
	              <li ><a href="/category/c2018.html">2018</a></li>
	              <li ><a href="/category/c2017.html">2017</a></li>
	              <li ><a href="/category/c2016.html">2016</a></li>
	              <li ><a href="/category/c2015.html">2015</a></li>
	              <li ><a href="/category/c2014.html">2014</a></li>
	              <li class="active"><a href="/category/c2013.html">2013</a></li>
	              <li ><a href="/category/c.html">...</a></li>
	          </ul>
	        </nav>

	          <aside>
	          <h2>Social</h2>
			    <ul class="social">
				  <li><a href="https://github.com/alejandroliu/">github</a><i></i></li>
				  <li><a href="https://www.linkedin.com/in/alejandro-liu-ly/">LinkedIn</a><i></i></li>
			    </ul>
			  </aside>

	          <aside>
	            <h2>Links</h2>
	            <ul>
	                <li><a href="https://github.com/alejandroliu/0ink.net">Repo</a></li>
	                <li><a href="https://alejandro.iliu.net/">Alejandro</a></li>
	                <li><a href="/tags.html">Tags</a></li>
	                <li><a href="/sitemap.html">sitemap</a></li>
	            </ul>
	          </aside>
	      </div>

	  </div>

      <footer>

		<p role="contentinfo">
		  © 2021 Alejandro Liu - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey">pelican-simplegrey</a>.
    	</p>

	  </footer>

	</div>


</body>
</html>