<!doctype html>
<html lang="">
<head>
	<meta charset="utf-8"/>
	<title>How to encrypt linux partitions with LUKS - 0ink.net</title>
	<meta name="author" content="Alejandro Liu">


	<meta name="description" content="There are plenty of reasons why people would need to encrypt a partition. Whether they're rooted it in privacy, security, or confidentiality, setting up a basic encrypted partition on a Linux system is fairly easy. This is especially true when using LUKS, since its functionality is built directly into the …">
	<meta name="int-title" content="How to encrypt linux partitions with LUKS">
	<meta name="tags" content="centos, device, drive, filesystem, linux, partition, privacy, security, sudo, tools, ubuntu">
	<meta name="date" content="2018-06-14 00:00:00+02:00">
	<meta name="revised" content="2021-12-22">


	<link rel="top" href="#" /><link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,300italic,400italic,600italic|Source+Code+Pro' rel='stylesheet' type='text/css'></link>
	<link rel="stylesheet" href="/theme/css/main.css" type="text/css" />


</head>

<body>

    <div class="container">

	  <header role="banner">
	    <div class="feeds">
	    </div>
		<nav class="pages">
			    <a href="/pages/about.html">About</a>
-			    <a href="/pages/privacy-policy.html">Privacy Policy</a>
		</nav>
		<a href="/" class="title"
 title="Not the site you are looking for..."		>
		0ink.net</a>
	      <div class="logo">
		<a href="/" class="title"
 title="Not the site you are looking for..."		>
		  <img src="/images/2021/0ink.png" width="44" height="44" />
		</a>
	      </div>



      </header>

	  <div class="wrapper">

		  <div role="main" class="content">
			<iframe src="https://duckduckgo.com/search.html?site=0ink.net&prefill=Search with DuckDuckGo" style="overflow:hidden;margin:5px;padding:0;width:408px;height:40px;" frameborder="0"></iframe>

	<article class="full">

		<h1>How to encrypt linux partitions with LUKS</h1>

<div class="metadata">
  <time datetime="2018-06-14T00:00:00+02:00" pubdate>Thu 14 June 2018</time>
    <address class="vcard author">
      by <a class="url fn" href="/author/alejandro-liu.html">Alejandro Liu</a>
    </address>
  in <a href="/category/c2018.html">2018</a>
<p class="tags">tagged <a href="/tag/centos.html">centos</a>, <a href="/tag/device.html">device</a>, <a href="/tag/drive.html">drive</a>, <a href="/tag/filesystem.html">filesystem</a>, <a href="/tag/linux.html">linux</a>, <a href="/tag/partition.html">partition</a>, <a href="/tag/privacy.html">privacy</a>, <a href="/tag/security.html">security</a>, <a href="/tag/sudo.html">sudo</a>, <a href="/tag/tools.html">tools</a>, <a href="/tag/ubuntu.html">ubuntu</a></p></div>
		<p>There are plenty of reasons why people would need to encrypt a
partition. Whether they're rooted it in privacy, security, or
confidentiality, setting up a basic encrypted partition on a Linux
system is fairly easy. This is especially true when using LUKS, since
its functionality is built directly into the kernel.</p>
<h1>Installing Cryptsetup</h1>
<h2>Debian/Ubuntu</h2>
<p>On both Debian and Ubuntu, the <code>cryptsetup</code> utility is easily
available in the repositories. The same should be true for Mint or
any of their other derivatives.</p>
<div class="highlight"><pre><span></span><code><span class="n">$</span> <span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="k">get</span> <span class="k">install</span> <span class="n">cryptsetup</span>
<span class="n n-Quoted">`</span><span class="n n-Quoted n-Quoted-Escape">``</span><span class="n n-Quoted">`</span>

<span class="c1">## CentOS/Fedora</span>

<span class="n">Again</span><span class="p">,</span> <span class="n">the</span> <span class="n">required</span> <span class="n">tools</span> <span class="n">are</span> <span class="n">easily</span> <span class="n">available</span> <span class="k">in</span> <span class="k">both</span> <span class="n">CentOS</span> <span class="k">and</span>
<span class="n">Fedora</span><span class="p">.</span> <span class="n">These</span> <span class="n">distributions</span> <span class="n">break</span> <span class="n">them</span> <span class="n">down</span> <span class="k">into</span> <span class="n">multiple</span> <span class="n">packages</span><span class="p">,</span>
<span class="n">but</span> <span class="n">they</span> <span class="n">can</span> <span class="n">still</span> <span class="n">be</span> <span class="n">easily</span> <span class="n">installed</span> <span class="k">using</span> <span class="n n-Quoted">`yum`</span> <span class="k">and</span> <span class="n n-Quoted">`dnf`</span>
<span class="n">respectively</span><span class="p">.</span>

<span class="c1">### CentOS</span>
</code></pre></div>

<h1>yum install crypto-utils cryptsetup-luks cryptsetup-luks-devel cryptsetup-luks-libs</h1>
<div class="highlight"><pre><span></span><code>### Fedora
</code></pre></div>

<h1>dnf install crypto-utils cryptsetup cryptsetup-luks</h1>
<div class="highlight"><pre><span></span><code><span class="c1">## OpenSUSE</span>

<span class="n">OpenSUSE</span> <span class="k">is</span> <span class="n">more</span> <span class="k">like</span> <span class="n">the</span> <span class="n">Debian</span> <span class="n">based</span> <span class="n">distributions</span><span class="p">,</span> <span class="n">including</span>
<span class="n">everything</span> <span class="n">that</span> <span class="n">you</span> <span class="n">need</span> <span class="k">with</span> <span class="n n-Quoted">`cryptsetup`</span><span class="p">.</span>
</code></pre></div>

<h1>zypper in cryptsetup</h1>
<div class="highlight"><pre><span></span><code>## Arch Linux

Arch stays true to its &quot;keep it simple&quot; philosophy here as well.
</code></pre></div>

<h1>pacman -S cryptsetup</h1>
<div class="highlight"><pre><span></span><code><span class="c1">## Gentoo</span>

<span class="n">The</span> <span class="n">main</span> <span class="n">concern</span> <span class="n">that</span> <span class="n">Gentoo</span> <span class="n">users</span> <span class="n">should</span> <span class="n">have</span> <span class="n">when</span> <span class="n">installing</span> <span class="n">the</span>
<span class="n">tools</span> <span class="n">necessary</span> <span class="k">for</span> <span class="n">using</span> <span class="n">LUKS</span> <span class="k">is</span> <span class="n">whether</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">their</span> <span class="n">kernel</span> <span class="n">has</span>
<span class="n">support</span><span class="o">.</span> <span class="n">This</span> <span class="n">guide</span> <span class="k">is</span> <span class="ow">not</span> <span class="n">going</span> <span class="n">to</span> <span class="n">cover</span> <span class="n">that</span> <span class="n">part</span><span class="p">,</span> <span class="n">but</span> <span class="n">just</span> <span class="n">be</span>
<span class="n">aware</span> <span class="n">that</span> <span class="n">kernel</span> <span class="n">support</span> <span class="k">is</span> <span class="n">a</span> <span class="n">factor</span><span class="o">.</span> <span class="n">If</span> <span class="n">your</span> <span class="n">kernel</span> <span class="n">does</span> <span class="n">support</span>
<span class="n">LUKS</span><span class="p">,</span> <span class="n">you</span> <span class="n">can</span> <span class="n">just</span> <span class="n">emerge</span> <span class="n">the</span> <span class="n">package</span><span class="o">.</span>
</code></pre></div>

<h1>emerge --ask cryptsetup</h1>
<div class="highlight"><pre><span></span><code># <span class="nv">Setting</span> <span class="nv">Up</span> <span class="nv">The</span> <span class="nv">Partition</span>

<span class="o">*</span><span class="nv">WARNING</span>:<span class="o">*</span> <span class="o">**</span><span class="nv">The</span> <span class="nv">following</span> <span class="nv">will</span> <span class="nv">erase</span> <span class="nv">all</span> <span class="nv">data</span> <span class="nv">on</span> <span class="nv">the</span> <span class="nv">partition</span> <span class="nv">being</span>
<span class="nv">used</span> <span class="nv">and</span> <span class="nv">will</span> <span class="nv">make</span> <span class="nv">it</span> <span class="nv">unrecoverable</span>. <span class="nv">Proceed</span> <span class="nv">with</span> <span class="nv">caution</span>.<span class="o">**</span>
<span class="nv">From</span> <span class="nv">here</span> <span class="nv">on</span>, <span class="nv">none</span> <span class="nv">of</span> <span class="nv">this</span> <span class="nv">is</span> <span class="nv">distribution</span> <span class="nv">specific</span>. <span class="nv">It</span> <span class="nv">will</span> <span class="nv">all</span> <span class="nv">work</span>
<span class="nv">well</span> <span class="nv">with</span> <span class="nv">any</span> <span class="nv">distribution</span>.<span class="nv">The</span> <span class="nv">defaults</span> <span class="nv">provided</span> <span class="nv">are</span> <span class="nv">actually</span> <span class="nv">quite</span>
<span class="nv">good</span>, <span class="nv">but</span> <span class="nv">they</span> <span class="nv">can</span> <span class="nv">easily</span> <span class="nv">be</span> <span class="nv">customized</span>. <span class="k">If</span> <span class="nv">you</span> <span class="nv">really</span> <span class="nv">aren</span><span class="s1">&#39;</span><span class="s">t</span>
<span class="nv">comfortable</span> <span class="nv">playing</span> <span class="nv">with</span> <span class="nv">them</span>, <span class="nv">don</span><span class="s1">&#39;</span><span class="s">t worry. If you do know what you</span>
<span class="nv">want</span> <span class="nv">to</span> <span class="k">do</span>, <span class="nv">feel</span> <span class="nv">free</span>.

<span class="nv">The</span> <span class="nv">basic</span> <span class="nv">options</span> <span class="nv">are</span> <span class="nv">as</span> <span class="nv">follows</span>:

<span class="o">*</span> <span class="o">--</span><span class="nv">cypher</span>:  <span class="nv">This</span> <span class="nv">determines</span> <span class="nv">the</span> <span class="nv">cryptographic</span> <span class="nv">cypher</span> <span class="nv">used</span> <span class="nv">on</span> <span class="nv">the</span>
  <span class="nv">partition</span>.  <span class="nv">The</span> <span class="nv">default</span> <span class="nv">option</span> <span class="nv">is</span> <span class="nv">aes</span><span class="o">-</span><span class="nv">xts</span><span class="o">-</span><span class="nv">plain64</span>
<span class="o">*</span> <span class="o">--</span><span class="nv">key</span><span class="o">-</span><span class="nv">size</span>: <span class="nv">The</span> <span class="nv">length</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">key</span> <span class="nv">used</span>.  <span class="nv">The</span> <span class="nv">default</span> <span class="nv">is</span> <span class="mi">256</span>
<span class="o">*</span> <span class="o">--</span><span class="nv">hash</span>: <span class="nv">Chooses</span> <span class="nv">the</span> <span class="nv">hash</span> <span class="nv">algorithm</span> <span class="nv">used</span> <span class="nv">to</span> <span class="nv">derive</span> <span class="nv">the</span> <span class="nv">key</span>.  <span class="nv">The</span>
  <span class="nv">default</span> <span class="nv">is</span> <span class="nv">sha256</span>.
<span class="o">*</span> <span class="o">--</span><span class="nv">time</span>: <span class="nv">The</span> <span class="nv">time</span> <span class="nv">used</span> <span class="k">for</span> <span class="nv">passphrase</span> <span class="nv">processing</span>.  <span class="nv">The</span> <span class="nv">default</span> <span class="nv">is</span>
  <span class="mi">2000</span> <span class="nv">milliseconds</span>.
<span class="o">*</span> <span class="o">--</span><span class="nv">use</span><span class="o">-</span><span class="k">random</span><span class="o">/--</span><span class="nv">use</span><span class="o">-</span><span class="nv">urandom</span>: <span class="nv">Determines</span> <span class="nv">the</span> <span class="k">random</span> <span class="nv">number</span> <span class="nv">generator</span>
  <span class="nv">used</span>.  <span class="nv">The</span> <span class="nv">default</span> <span class="nv">is</span> <span class="o">--</span><span class="nv">use</span><span class="o">-</span><span class="k">random</span>.

<span class="nv">So</span>, <span class="nv">a</span> <span class="nv">basic</span> <span class="nv">command</span> <span class="nv">with</span> <span class="nv">no</span> <span class="nv">options</span> <span class="nv">would</span> <span class="nv">look</span> <span class="nv">like</span> <span class="nv">the</span> <span class="nv">line</span> <span class="nv">below</span>.
</code></pre></div>

<h1>cryptsetup luksFormat /dev/sdb1</h1>
<div class="highlight"><pre><span></span><code><span class="nv">Obviously</span>, <span class="nv">you</span><span class="s1">&#39;</span><span class="s">d want to use the path to whichever partition that</span>
<span class="nv">you</span><span class="s1">&#39;</span><span class="s">re encrypting. If you do want to use options, it would look like</span>
<span class="nv">the</span> <span class="nv">following</span>.
</code></pre></div>

<h1>cryptsetup -c aes-xts-plain64 --key-size 512 --hash sha512 --time 5000 --use-urandom /dev/sdb1</h1>
<div class="highlight"><pre><span></span><code><span class="n n-Quoted">`Cryptsetup`</span> <span class="n">will</span> <span class="n">ask</span> <span class="k">for</span> <span class="n">a</span> <span class="n">passphrase</span><span class="p">.</span> <span class="n">Choose</span> <span class="k">one</span> <span class="n">that</span> <span class="k">is</span> <span class="k">both</span>
<span class="n">secure</span> <span class="k">and</span> <span class="n">memorable</span><span class="p">.</span> <span class="k">If</span> <span class="n">you</span> <span class="n">forget</span> <span class="n">it</span><span class="p">,</span> <span class="n">your</span> <span class="k">data</span> <span class="o">*</span><span class="n">will</span> <span class="n">be</span> <span class="n">lost</span><span class="p">.</span><span class="o">*</span>
<span class="n">That</span> <span class="n">will</span> <span class="n">probably</span> <span class="n">take</span> <span class="n">a</span> <span class="n">few</span> <span class="n">seconds</span> <span class="k">to</span> <span class="n">complete</span><span class="p">,</span> <span class="n">but</span> <span class="k">when</span> <span class="n">it</span><span class="s1">&#39;s</span>
<span class="s1">done, it will have successfully converted your partition into an</span>
<span class="s1">encrypted LUKS volume. </span>

<span class="s1">Next, you have to open the volume onto the device mapper. This is the</span>
<span class="s1">stage at which you will be prompted for your passphrase. You can</span>
<span class="s1">choose the name that you want your partition mapped under. It doesn&#39;</span><span class="n">t</span>
<span class="n">really</span> <span class="n">matter</span> <span class="n">what</span> <span class="n">it</span> <span class="k">is</span><span class="p">,</span> <span class="n">so</span> <span class="n">just</span> <span class="n">pick</span> <span class="n">something</span> <span class="n">that</span> <span class="n">will</span> <span class="n">be</span> <span class="n">easy</span> <span class="k">to</span>
<span class="n">remember</span> <span class="k">and</span> <span class="k">use</span><span class="p">.</span>
</code></pre></div>

<h1>cryptsetup open /dev/sdb1 encrypted</h1>
<div class="highlight"><pre><span></span><code><span class="n">Once</span> <span class="n">the</span> <span class="n">drive</span> <span class="n">is</span> <span class="n">mapped</span><span class="p">,</span> <span class="n">you</span><span class="p">&#39;</span><span class="n">ll</span> <span class="n">have</span> <span class="n">to</span> <span class="n">choose</span> <span class="n">a</span> <span class="n">filesystem</span> <span class="k">type</span> <span class="k">for</span>
<span class="n">you</span> <span class="n">partition</span><span class="p">.</span> <span class="n">Creating</span> <span class="n">that</span> <span class="n">filesystem</span> <span class="n">is</span> <span class="n">the</span> <span class="n">same</span> <span class="n">as</span> <span class="n">it</span> <span class="n">would</span> <span class="n">be</span> <span class="n">on</span>
<span class="n">a</span> <span class="n">regular</span> <span class="n">partition</span><span class="p">.</span>
</code></pre></div>

<h1>mkfs.ext4 /dev/mapper/encrypted</h1>
<div class="highlight"><pre><span></span><code><span class="n">The</span> <span class="n">one</span> <span class="n">difference</span> <span class="n">between</span> <span class="n">creating</span> <span class="n">the</span> <span class="n">filesystem</span> <span class="n">on</span> <span class="n">a</span> <span class="n">regular</span>
<span class="n">partition</span> <span class="k">and</span> <span class="n">an</span> <span class="n">encrypted</span> <span class="n">one</span> <span class="n">is</span> <span class="n">that</span> <span class="n">you</span> <span class="n">will</span> <span class="n">use</span> <span class="n">the</span> <span class="n">path</span> <span class="n">to</span> <span class="n">the</span>
<span class="n">mapped</span> <span class="n">name</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">the</span> <span class="n">actual</span> <span class="n">partition</span> <span class="n">location</span><span class="p">.</span> <span class="n">Wait</span> <span class="k">for</span> <span class="n">the</span>
<span class="n">filesystem</span> <span class="n">to</span> <span class="n">be</span> <span class="n">created</span><span class="p">.</span> <span class="n">Then</span><span class="p">,</span> <span class="n">the</span> <span class="n">drive</span> <span class="n">will</span> <span class="n">be</span> <span class="n">ready</span> <span class="k">for</span> <span class="n">use</span><span class="p">.</span>

<span class="p">#</span> <span class="n">Mounting</span> <span class="k">and</span> <span class="n">Unmounting</span>

<span class="n">Manually</span> <span class="n">mounting</span> <span class="k">and</span> <span class="n">unmounting</span> <span class="n">encrypted</span> <span class="n">partitions</span> <span class="n">is</span> <span class="n">almost</span> <span class="n">the</span>
<span class="n">same</span> <span class="n">as</span> <span class="n">doing</span> <span class="n">so</span> <span class="n">with</span> <span class="n">normal</span> <span class="n">partitions</span><span class="p">.</span> <span class="n">There</span> <span class="n">is</span> <span class="n">one</span> <span class="n">more</span> <span class="n">step</span> <span class="n">in</span>
<span class="n">each</span> <span class="n">direction</span><span class="p">,</span> <span class="n">though</span><span class="p">.</span> <span class="n">First</span><span class="p">,</span> <span class="n">to</span> <span class="n">manually</span> <span class="n">mount</span> <span class="n">an</span> <span class="n">encrypted</span>
<span class="n">partition</span><span class="p">,</span> <span class="n">run</span> <span class="n">the</span> <span class="n">command</span> <span class="n">below</span><span class="p">.</span>
</code></pre></div>

<h1>cryptsetup --type luks open /dev/sdb1 encrypted</h1>
<h1>mount -t ext4 /dev/mapper/encrypted /place/to/mount</h1>
<div class="highlight"><pre><span></span><code>Unmounting the partition is the same as a normal one, but you have to
close the mapped device too.
</code></pre></div>

<h1>umount /place/to/mount</h1>
<h1>cryptsetup close encrypted</h1>
<p>```</p>
<h1>Closing</h1>
<p>There's plenty more, but when talking about security and encryption,
things run rather deep. This guide provides the basis for encrypting
and using encrypted partitions, which is an important first step that
shouldn't be discounted. There will definitely be more coming in this
area, so be sure to check back, if you're interested in going a bit
deeper.</p>
<hr>
<p>Source <a href="https://linuxconfig.org/basic-guide-to-encrypting-linux-partitions-with-luks">linuxconfig</a></p>

	</article>


		  </div>

		  <div class="sidebar">

	        <nav>
	          <h2>Years</h2>
	          <ul>
	              <li ><a href="/category/c2021.html">2021</a></li>
	              <li ><a href="/category/c2020.html">2020</a></li>
	              <li ><a href="/category/c2019.html">2019</a></li>
	              <li class="active"><a href="/category/c2018.html">2018</a></li>
	              <li ><a href="/category/c2017.html">2017</a></li>
	              <li ><a href="/category/c2016.html">2016</a></li>
	              <li ><a href="/category/c2015.html">2015</a></li>
	              <li ><a href="/category/c2014.html">2014</a></li>
	              <li ><a href="/category/c2013.html">2013</a></li>
	              <li ><a href="/category/c.html">...</a></li>
	          </ul>
	        </nav>

	          <aside>
	          <h2>Social</h2>
			    <ul class="social">
				  <li><a href="https://github.com/alejandroliu/">github</a><i></i></li>
				  <li><a href="https://www.linkedin.com/in/alejandro-liu-ly/">LinkedIn</a><i></i></li>
			    </ul>
			  </aside>

	          <aside>
	            <h2>Links</h2>
	            <ul>
	                <li><a href="https://github.com/alejandroliu/0ink.net">Repo</a></li>
	                <li><a href="https://alejandro.iliu.net/">Alejandro</a></li>
	                <li><a href="/tags.html">Tags</a></li>
	                <li><a href="/sitemap.html">sitemap</a></li>
	            </ul>
	          </aside>
	      </div>

	  </div>

      <footer>

		<p role="contentinfo">
		  © 2021 Alejandro Liu - Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme <a href="https://github.com/fle/pelican-simplegrey">pelican-simplegrey</a>.
    	</p>

	  </footer>

	</div>


</body>
</html>