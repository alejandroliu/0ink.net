<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <title>Mirroring a Gitorious repository to GitHub</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <meta name="description" content="There is nothing special with GitHub and Gitorious here. This technique would work exactly the same the other way around or with other servers. In..." />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">0ink.net</a></h1>
                <nav><ul>
                    <li><a href="/pages/about.html">About</a></li>
                    <li><a href="/pages/privacy-policy.html">Privacy Policy</a></li>
                    <li class="active"><a href="/category/blog.html">Blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/mirroring-a-gitorious-repository-to-github.html" rel="bookmark"
           title="Permalink to Mirroring a Gitorious repository to GitHub">Mirroring a Gitorious repository to GitHub</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2013-05-27T00:00:00+02:00">
                Published: Mon 27 May 2013
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/alejandro-liu.html">Alejandro Liu</a>
        </address>
<p>In <a href="/category/blog.html">Blog</a>.</p>

</footer><!-- /.post-info -->      <p>There is nothing special with <a href="http://github.com/">GitHub</a> and
<a href="http://gitorious.com/">Gitorious</a> here. This technique would work
exactly the same the other way around or with other servers.</p>
<h1>In a nutshell</h1>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">Inital</span><span class="w"> </span><span class="n">setup</span><span class="w"></span>
<span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="o">--</span><span class="n">mirror</span><span class="w"> </span><span class="nl">git</span><span class="p">:</span><span class="o">//</span><span class="n">gitorious</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">weasyprint</span><span class="o">/</span><span class="n">weasyprint</span><span class="p">.</span><span class="n">git</span><span class="w"> </span><span class="n">weasyprint</span><span class="w"></span>
<span class="n">GIT_DIR</span><span class="o">=</span><span class="n">weasyprint</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">github</span><span class="w"> </span><span class="n">git</span><span class="nv">@github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">SimonSapin</span><span class="o">/</span><span class="n">WeasyPrint</span><span class="p">.</span><span class="n">git</span><span class="w"></span>

<span class="err">#</span><span class="w"> </span><span class="ow">In</span><span class="w"> </span><span class="n">cron</span><span class="w"></span>
<span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="k">path</span><span class="o">/</span><span class="k">to</span><span class="o">/</span><span class="n">project</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="k">fetch</span><span class="w"> </span><span class="o">-</span><span class="n">q</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="o">-</span><span class="n">q</span><span class="w"> </span><span class="c1">--mirror github</span>
</code></pre></div>

<h1>How it works</h1>
<p>Mirroring with Git is pretty easy: just pull from or push to another
repository. <a href="http://github.com/">GitHub</a> and
<a href="http://gitorious.com/">Gitorious</a> allow you to push to them or pull
from them, but you can not make them push to somewhere else. You need
something in the middle. Digging a bit in the man pages tells you that
the magic option is <code>--mirror</code>. First, clone your "source" repository:</p>
<div class="highlight"><pre><span></span><code>git clone --mirror git://gitorious.org/weasyprint/weasyprint.git weasyprint
</code></pre></div>

<p><code>--mirror</code> implies <code>--bare</code>. This repository is not for working, you
don't want it to have a working directory. More importantly, <code>--mirror</code>
sets up the origin remote so that git fetch will directly fetch into
local branches without doing any merge. It will force the update if
the remote history has diverged from the local one.</p>
<div class="highlight"><pre><span></span><code>git fetch
</code></pre></div>

<p>Now our local repository is an exact mirror of what we have on
<a href="http://gitorious.com/">Gitorious</a>. Let's push it to <a href="http://github.com/">GitHub</a>:</p>
<div class="highlight"><pre><span></span><code><span class="n">git</span><span class="w"> </span><span class="n">remote</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="n">github</span><span class="w"> </span><span class="n">git</span><span class="nv">@github</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="n">SimonSapin</span><span class="o">/</span><span class="n">WeasyPrint</span><span class="p">.</span><span class="n">git</span><span class="w"></span>
<span class="n">git</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="c1">--mirror github</span>
</code></pre></div>

<p>The <code>--mirror</code> option for git push is similar to that for git clone:
instead of pushing just a branch, it says that all references (branches,
tags, -) should be the same on the remote end as they are here, even if
it means forced updates or removing. Now our
<a href="http://gitorious.com/">GitHub</a> repository also is a mirror. Let's
update it every hour with cron. The <code>-q</code> option says to suppress normal
output but keep error messages, which cron should send you by email if
your server is properly configured.</p>
<div class="highlight"><pre><span></span><code><span class="mf">42</span> <span class="o">*</span>    <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>   <span class="n">cd</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="kr">to</span><span class="o">/</span><span class="n">weasyprint</span> <span class="err">&amp;&amp;</span> <span class="n">git</span> <span class="n">fetch</span> <span class="o">-</span><span class="n">q</span> <span class="err">&amp;&amp;</span> <span class="n">git</span> <span class="n">push</span> <span class="o">-</span><span class="n">q</span> <span class="o">--</span><span class="n">mirror</span> <span class="n">github</span>
</code></pre></div>

<h3>Warning: <code>--mirror</code> is like <code>--force</code></h3>
<p>Both <code>--mirror</code> options are kind of like <code>--force</code> in that you can
lose data if you're not careful. It will make exact mirrors, no question
asked. If you push changes to the mirror's destination, they will be
overwritten/removed on the next update if they are not in the mirror's
source.</p>
<p>Original article by Simon Sapin: <a href="http://exyr.org/2011/git-mirrors/">http://exyr.org/2011/git-mirrors/</a></p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://www.iliu.net">Familia</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://github.com/alejandroliu/0ink.net">github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>